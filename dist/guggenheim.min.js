(function(global){var _scope=this,endEventName,endAnimationName,vendors={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},document=window.document,testEl=document.createElement("div"),supportedTransforms=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,clearProperties={};easing={ease:function(pos){return-Math.cos(pos*Math.PI)/2+.5},linear:function(pos){return pos}},animating=!1,prefix="";function _downcase(str){return str.toLowerCase()}function _normalizeEvent(name){return eventPrefix?eventPrefix+name:_downcase(name)}function _getObjKeys(obj){if(typeof obj!="object")return[];var keys=[],prop;for(prop in obj)keys.push(prop);return keys}function _getObjVars(obj){if(typeof obj!="object")return[];var vars=[],prop;for(prop in obj)vars.push(obj[prop]);return vars}function _mergeOptions(destination,source){var property,prop;for(property in source)if(_getObjVars(destination[property]).length>0&&_scope._getObjVars(source[property]).length>0)for(prop in source[property])destination[property][prop]=source[property][prop];else destination[property]=source[property];return destination}function _getElementDimensions(el){var style=window.getComputedStyle?window.getComputedStyle(el,null):el.currentStyle;return{height:parseFloat(style.height)+(parseFloat(style.paddingTop)||0)+(parseFloat(style.paddingBottom)||0)+(parseFloat(style.borderTopWidth)||0)+(parseFloat(style.borderBottomWidth)||0),width:parseFloat(style.width)+(parseFloat(style.paddingLeft)||0)+(parseFloat(style.paddingRight)||0)+(parseFloat(style.borderLeftWidth)||0)+(parseFloat(style.borderRightWidth)||0),margin:{top:parseFloat(style.marginTop)||0,right:parseFloat(style.marginRight)||0,bottom:parseFloat(style.marginBottom)||0,left:parseFloat(style.marginLeft)||0}}}function _addEvent(el,event,callback){el.addEventListener?el.addEventListener(event,callback,!1):el.attachEvent(event,callback)}function _removeEvent(el,event,callback){el.removeEventListener?el.removeEventListener(event,callback,!1):el.detachEvent(event,callback)}function _interpolate(source,target,pos){return(source+(target-source)*pos).toFixed(3)}function _parseProps(prop){var p=parseFloat(prop),q=prop.replace(/^[\-\d\.]+/,"");return isNaN(p)?{v:q,f:color,u:""}:{v:p,f:_interpolate,u:q}}function _animate(el,props,callback){var transitions=[],key,start=(new Date).getTime(),duration=_scope.options.duration*1e3,finish=start+duration,comp=el.currentStyle?el.currentStyle:getComputedStyle(el,null),current={},interval,target={},prop,time=(new Date).getTime(),pos;if(_scope.prefix!=""){for(key in props)transitions.push(key);el.style.setProperty(_scope.prefix+"transition-property",transitions.join(", "),""),el.style.setProperty(_scope.prefix+"transition-duration",_scope.options.duration+"s",""),el.style.setProperty(_scope.prefix+"transition-timing-function",_scope.options.easing,""),_scope.options.duration>0&&_addEvent(el,_normalizeEvent("TransitionEnd"),callback);for(key in props)el.style[key]=props[key]}else{for(prop in props)target[prop]=_parseProps(props[prop]);for(prop in props)current[prop]=_parseProps(comp[prop]);interval=setInterval(function(){pos=time>finish?1:(time-start)/duration;for(prop in target)el.style[prop]=target[prop].f(current[prop].v,target[prop].v,easing[_scope.options.easing](pos))+target[prop].u;time>finish&&(clearInterval(interval),callback!==undefined&&callback.call())},10)}}_scope.prev=function(){if(_scope.animating)return!1;_scope.animating=!0;var slider=_scope.container.querySelector(_scope.options.slider),containerDimensions=_getElementDimensions(_scope.container),elDimensions=_getElementDimensions(_scope.elements[0]),pages=Math.ceil(_scope.filteredElements.length/(_scope.options.rows*_scope.options.cols)),sliderWidth=pages*containerDimensions.width;parseFloat(slider.offsetLeft)!=0?_animate(slider,{left:parseFloat(slider.offsetLeft)+containerDimensions.width+"px"},function(){_scope.animating=!1}):_scope.animating=!1},_scope.next=function(){if(_scope.animating)return!1;_scope.animating=!0;var slider=_scope.container.querySelector(_scope.options.slider),containerDimensions=_getElementDimensions(_scope.container),elDimensions=_getElementDimensions(_scope.elements[0]),pages=Math.ceil(_scope.filteredElements.length/(_scope.options.rows*_scope.options.cols)),sliderWidth=pages*containerDimensions.width;parseFloat(slider.offsetLeft)>-(sliderWidth-containerDimensions.width)?_animate(slider,{left:parseFloat(slider.offsetLeft)-containerDimensions.width+"px"},function(){_scope.animating=!1}):_scope.animating=!1},_scope.filter=function(filterFunction){var row=0,col=0,top,left,dimensions=_getElementDimensions(_scope.elements[0]),containerDimensions=_getElementDimensions(_scope.container),page=0,i,props={},classString;if(typeof filterFunction=="string"||Array.isArray(filterFunction))classString=typeof filterFunction=="string"?filterFunction:"(?=.*\\b"+filterFunction.join("\\b)(?=.*\\b")+"\\b)",filterFunction=function(el){return(new RegExp("(^|\\s)"+classString+"(\\s|$)")).test(el.className)};_scope.filteredElements=[];for(i=0;i<_scope.orderedElements.length;i++)filterFunction(_scope.orderedElements[i])?(_scope.filteredElements.push(_scope.orderedElements[i]),top=(dimensions.height+dimensions.margin.bottom)*row+dimensions.margin.top,left=(dimensions.width+dimensions.margin.right)*col+containerDimensions.width*page+dimensions.margin.left,props={top:top+"px",left:left+"px",opacity:1},col++,col==_scope.options.cols&&(col=0,row++,row==_scope.options.rows&&(row=0,page++))):props={opacity:0},_animate(_scope.orderedElements[i],props)},_scope.order=function(orderedResults){var row=0,col=0,top,left,dimensions=_getElementDimensions(_scope.elements[0]),containerDimensions=_getElementDimensions(_scope.container),page=0,i,props={},el;_scope.orderedElements=[];for(i=0;i<orderedResults.length;i++)el=_scope.container.querySelector(orderedResults[i]),_scope.orderedElements.push(el),_scope.filteredElements.indexOf(el)!=-1&&(top=(dimensions.height+dimensions.margin.bottom)*row+dimensions.margin.top,left=(dimensions.width+dimensions.margin.right)*col+containerDimensions.width*page+dimensions.margin.left,props={top:top+"px",left:left+"px",opacity:1},_animate(el,props),col++,col==_scope.options.cols&&(col=0,row++,row==_scope.options.rows&&(row=0,page++)))},_scope.reset=function(){var initialOrder=[];_scope.filteredElements=_scope.orderedElements=[];for(i=0;i<_scope.elements.length;i++)_scope.filteredElements.push(_scope.elements[i]),initialOrder.push("#"+_scope.elements[i].id);_scope.orderedElements=_scope.filteredElements,order(initialOrder)},_scope.setUpElements=function(){var i,width=0,height=0,containerDimensions=_getElementDimensions(_scope.container);for(i=0;i<_scope.elements.length;i++)dimensions=_getElementDimensions(_scope.elements[i]),dimensions.width>width&&(width=dimensions.width),dimensions.height>height&&(height=dimensions.height);width>containerDimensions.width/_scope.options.cols&&(width=Math.floor(containerDimensions.width/_scope.options.cols)),height>containerDimensions.height/_scope.options.rows&&(height=Math.floor(containerDimensions.height/_scope.options.rows));for(i=0;i<_scope.elements.length;i++)_scope.elements[i].style.position="absolute",_scope.elements[i].style.width=width+"px",_scope.elements[i].style.height=height+"px"};function initialize(element,options){if(typeof element=="string"&&document.querySelector(element)==null)throw new Exception("Element "+element+" does not exist!");_scope.container=typeof element=="string"?document.querySelector(element):element,_scope.container.style.overflow="hidden",_scope.options=_mergeOptions({selector:"div.guggenheim-item",rows:"auto",cols:"auto",duration:.5,easing:"ease",slider:"div.guggenheim-slider"},options),_scope.elements=_scope.container.querySelectorAll(_scope.options.selector);if(!_scope.elements)throw new Exception("Gallery is empty");_scope.setUpElements();var containerDimensions=_getElementDimensions(_scope.container),elDimensions,width,height,i,slider;return _scope.options.cols=="auto"&&(dimensions=_getElementDimensions(_scope.elements[0]),width=dimensions.width+dimensions.margin.left+dimensions.margin.right,_scope.options.cols=Math.floor(containerDimensions.width/width)),_scope.options.rows=="auto"&&(dimensions=_getElementDimensions(_scope.elements[0]),height=dimensions.height+dimensions.margin.top+dimensions.margin.bottom,_scope.options.rows=Math.floor(containerDimensions.height/height)),slider=_scope.container.querySelector(_scope.options.slider),slider.style.left="0px",slider.style.position="relative",_scope.reset(),_scope}(function(){var values=_getObjVars(vendors),keys=_getObjKeys(vendors),i;for(i=0;i<keys.length;i++)if(testEl.style[keys[i]+"TransitionProperty"]!==undefined)return _scope.prefix="-"+_downcase(keys[i])+"-",_scope.eventPrefix=values[i],!1})(),clearProperties[prefix+"transition-property"]=clearProperties[prefix+"transition-duration"]=clearProperties[prefix+"transition-timing-function"]=clearProperties[prefix+"animation-name"]=clearProperties[prefix+"animation-duration"]="",global.guggenheim=initialize})(this),Array.isArray||(Array.isArray=function(arg){return Object.prototype.toString.call(arg)=="[object Array]"})